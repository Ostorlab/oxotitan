# This file was generated. Do not edit manually.

schema {
    query: Query
    mutation: Mutations
}

union OxoAssetType = OxoAndroidFileAssetType | OxoAndroidStoreAssetType | OxoIOSFileAssetType | OxoIOSStoreAssetType | OxoNetworkAssetType | OxoUrlAssetType

"Graphene object type for a list of agent arguments."
type AgentArgumentType {
    description: String
    id: ID!
    name: String
    type: String
    value: Bytes
}

"Graphene object type for a list of agent arguments."
type AgentArgumentsType {
    args: [AgentArgumentType]!
}

"SQLAlchemy object type for an agent group."
type AgentGroupType {
    agents: AgentsType!
    createdTime: DateTime
    description: String
    id: ID!
    key: String
    name: String
}

type AgentGroupsType {
    agentGroups: [AgentGroupType]!
    pageInfo: PageInfo
}

"SQLAlchemy object type for an agent."
type AgentType {
    args: AgentArgumentsType!
    id: ID!
    key: String
}

"Graphene object type for a list of agents."
type AgentsType {
    agents: [AgentType]!
}

"Create asset mutation."
type CreateAssetsMutation {
    assets: [OxoAssetType]
}

"Delete agent group mutation."
type DeleteAgentGroupMutation {
    result: Boolean
}

"Delete Scan & its information mutation."
type DeleteScanMutation {
    result: Boolean
}

"Import scan mutation."
type ImportScanMutation {
    message: String
}

type Mutations {
    "Create an asset."
    createAssets(assets: [OxoAssetInputType]!): CreateAssetsMutation
    "Delete agent group."
    deleteAgentGroup(agentGroupId: Int!): DeleteAgentGroupMutation
    "Delete a scan & all its information."
    deleteScan(scanId: Int!): DeleteScanMutation
    "Import scan from file."
    importScan(file: Upload!, scanId: Int): ImportScanMutation
    "Create agent group"
    publishAgentGroup(agentGroup: AgentGroupCreateInputType!): PublishAgentGroupMutation
    "Run scan"
    runScan(scan: OxoAgentScanInputType!): RunScanMutation
    "Stops running scan, scan is marked as stopped once the engine has completed cancellation."
    stopScan(scanId: Int!): StopScanMutation
}

"Graphene object type for an aggregated knowledge base vulnerability."
type OxoAggregatedKnowledgeBaseVulnerabilityType {
    highestCvssV3BaseScore: Float
    highestCvssV3Vector: String
    highestRiskRating: RiskRatingEnum
    kb: OxoKnowledgeBaseVulnerabilityType
    "List of vulnerabilities."
    vulnerabilities(detailTitles: [String], numberElements: Int, page: Int): OxoVulnerabilitiesType
}

type OxoAndroidFileAssetType {
    id: ID!
    packageName: String
    path: String
    scanId: Int
    scans(lastOnly: Boolean): [OxoScanType]
    type: String
}

type OxoAndroidStoreAssetType {
    applicationName: String
    id: ID!
    packageName: String
    scanId: Int
    scans(lastOnly: Boolean): [OxoScanType]
    type: String
}

type OxoIOSFileAssetType {
    bundleId: String
    id: ID!
    path: String
    scanId: Int
    scans(lastOnly: Boolean): [OxoScanType]
    type: String
}

type OxoIOSStoreAssetType {
    applicationName: String
    bundleId: String
    id: ID!
    scanId: Int
    scans(lastOnly: Boolean): [OxoScanType]
    type: String
}

"SQLAlchemy object type for a knowledge base vulnerability."
type OxoKnowledgeBaseVulnerabilityType {
    description: String
    recommendation: String
    references: [OxoReferenceType]
    shortDescription: String
    title: String
}

type OxoNetworkAssetType {
    id: ID!
    networks: [String]
    scanId: Int
    scans(lastOnly: Boolean): [OxoScanType]
    type: String
}

"Graphene object type for a reference."
type OxoReferenceType {
    title: String
    url: String
}

"Scan object."
type OxoScanType {
    assets: [OxoAssetType]
    createdTime: DateTime
    id: ID!
    "List of aggregated knowledge base vulnerabilities."
    kbVulnerabilities(detailTitle: String): [OxoAggregatedKnowledgeBaseVulnerabilityType]
    messageStatus: String
    progress: String
    title: String
    "List of vulnerabilities."
    vulnerabilities(detailTitles: [String], numberElements: Int, page: Int, vulnIds: [Int]): OxoVulnerabilitiesType
}

"Graphene object type for a list of scans."
type OxoScansType {
    pageInfo: PageInfo
    scans: [OxoScanType]!
}

type OxoUrlAssetType {
    id: ID!
    links: [String]
    scanId: Int
    scans(lastOnly: Boolean): [OxoScanType]
    type: String
}

"Graphene object type for a list of vulnerabilities."
type OxoVulnerabilitiesType {
    pageInfo: PageInfo
    vulnerabilities: [OxoVulnerabilityType]!
}

"SQLAlchemy object type for a vulnerability."
type OxoVulnerabilityType {
    cvssV3BaseScore: Float
    cvssV3Vector: String
    detail: OxoKnowledgeBaseVulnerabilityType
    dna: String
    id: ID!
    riskRating: RiskRating
    technicalDetail: String
}

"Page info object type."
type PageInfo {
    count: Int
    hasNext: Boolean
    hasPrevious: Boolean
    numPages: Int
}

"Create agent group."
type PublishAgentGroupMutation {
    agentGroup: AgentGroupType
}

type Query {
    agentGroups(agentGroupIds: [Int], numberElements: Int, orderBy: AgentGroupOrderByEnum, page: Int, search: String, sort: SortEnum): AgentGroupsType
    "Retrieve scan by id."
    scan(scanId: Int): OxoScanType
    "List of scans."
    scans(numberElements: Int, orderBy: OxoScanOrderByEnum, page: Int, scanIds: [Int], sort: SortEnum): OxoScansType
}

type RunScanMutation {
    scan: OxoScanType
}

"Stop scan mutation."
type StopScanMutation {
    scan: OxoScanType
}

enum AgentGroupOrderByEnum {
    AgentGroupId
    CreatedTime
    Name
}

"Enum for the elements to order a scan by."
enum OxoScanOrderByEnum {
    CreatedTime
    Progress
    ScanId
    Title
}

"Enumeration of the risk rating of a scan."
enum RiskRating {
    CRITICAL
    HARDENING
    HIGH
    IMPORTANT
    INFO
    LOW
    MEDIUM
    POTENTIALLY
    SECURE
}

"Enum for the risk rating of a scan."
enum RiskRatingEnum {
    CRITICAL
    HARDENING
    HIGH
    IMPORTANT
    INFO
    LOW
    MEDIUM
    POTENTIALLY
    SECURE
}

"Sort enum, for the sorting order of the results."
enum SortEnum {
    Asc
    Desc
}

"The `Bytes` scalar type represents binary data in a bytes format."
scalar Bytes

"""

The `DateTime` scalar type represents a DateTime
value as specified by
[iso8601](https://en.wikipedia.org/wiki/ISO_8601).
"""
scalar DateTime

"""

Create scalar that ignores normal serialization/deserialization, since
that will be handled by the multipart request spec
"""
scalar Upload

"Input object type for an agent argument."
input AgentArgumentInputType {
    description: String
    name: String!
    type: String!
    value: Bytes
}

"Input object type for creating an agent group agent."
input AgentGroupAgentCreateInputType {
    args: [AgentArgumentInputType]
    key: String!
}

"Input object type for creating an agent group."
input AgentGroupCreateInputType {
    agents: [AgentGroupAgentCreateInputType]!
    description: String!
    name: String!
}

input OxoAgentScanInputType {
    agentGroupId: Int!
    assetIds: [Int]!
    title: String
}

input OxoAndroidFileAssetInputType {
    file: Upload
    packageName: String
}

input OxoAndroidStoreAssetInputType {
    applicationName: String
    packageName: String
}

input OxoAssetInputType {
    androidFile: OxoAndroidFileAssetInputType
    androidStore: OxoAndroidStoreAssetInputType
    iosFile: OxoIOSFileAssetInputType
    iosStore: OxoIOSStoreAssetInputType
    network: OxoNetworkAssetInputType
    url: OxoUrlAssetInputType
}

input OxoIOSFileAssetInputType {
    bundleId: String
    file: Upload
}

input OxoIOSStoreAssetInputType {
    applicationName: String
    bundleId: String
}

input OxoNetworkAssetInputType {
    networks: [String]
}

input OxoUrlAssetInputType {
    links: [String]
}
